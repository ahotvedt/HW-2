---
title: "MATH 216 Homework 2"
author: "Amanda Hotvedt"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    smooth_scroll: false
---

```{r, echo=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(readr)
library(tidyr)
library(forcats)
```


```{r, echo=FALSE, message=FALSE, cache=TRUE}
# Do not edit this code block. By setting cache=TRUE, we are saving the output 
# of this block to the cache. That way it only needs to run once.  This is
# especially useful for portions of code that take a long time to run.
profiles <- read_csv(file="profiles.csv")
```



## Admistrative:

Please indicate

* Who you collaborated with: Katherine Hobbs
* Roughly how much time you spent on this HW so far: 3 hours
* The URL of the RPubs published URL [here](https://www.nhl.com/).
* What gave you the most trouble: I feel like I have set the Shiny app up correctly, but I am not sure how to tell it how to switch between the Comedies/Non-Comedies data even though the button exists
* Any comments you have:



## Question 1:

Perform an Exploratory Data Analysis (EDA) on the `profiles` data set,
specifically on the relationship between gender and

* `income`
* `job`
* One more categorical variable of your choice (I picked 'orientation')

all keeping in mind in HW-3, you will be fitting a logistic regression to
predict a user's gender based on these variables.

```{r, echo=TRUE, message=TRUE, warning=TRUE, fig.width=8, fig.height=4.5}

profiles <- profiles %>%
  mutate(is_female = ifelse(sex=="f", 1, 0))

profiles2 <- profiles %>% 
  select(is_female, job, income, orientation)

# Percentage of users that are female
profiles2 %>% 
  summarise(mean(is_female))

# Average income in full data set
profiles2 %>% 
  summarise("Average Income" = mean(income))

# Average income, after filtering out the non-sensical incomes (e.g., -1)
profiles2 %>% 
  filter(income != -1) %>% 
  summarise("Average Income" = mean(income))

# Average income by gender
profiles2 %>% 
  filter(income != -1) %>% 
  group_by(is_female) %>% 
  summarise("Average Income By Gender" = mean(income))

profiles3 <- profiles2 %>% 
  filter(income != -1)

ggplot(data=profiles3, aes(x=income, y=..density..)) +
  geom_histogram(binwidth=30000) +
  facet_wrap(~is_female)

# Average Income by Job Title (still haven't figured out to arrange this in
# descending order)
profiles3 <- profiles3 %>%
  group_by(job) %>% 
  mutate(avg_inc_by_job = mean(income)) %>% 
  arrange(desc())

# Proportion of Females in Each Job
profiles3 %>% 
  group_by(job) %>% 
  summarise("Proportion that are Female" = mean(is_female))

# Average Income by Job Title by Gender
income_by_job_gender <- profiles3 %>% 
  group_by(job,is_female) %>% 
  summarise("Average Income by Job Title" = mean(income)) %>% 
  spread(key=is_female, value="Average Income by Job Title")

# not finished plot yet...still having trouble making a visual
# representation of the data here
ggplot(data=income_by_job_gender, aes(x=job, y="Average Income by Job Title", fill=as.factor(is_female))) +
  geom_point()

# Proportion of Females by Orientation
profiles2 %>% 
  group_by(orientation) %>% 
  summarise("Proportion that are Female" = mean(is_female))

# Average income by Orientation
profiles2 %>% 
  filter(income != -1) %>% 
  group_by(orientation) %>% 
  summarise("Average Income By Orientation" = mean(income))
```



## Question 2:

In the file `HW-2_Shiny_App.Rmd`, build the Shiny App discussed in Lec09 on
Monday 10/3: Using the `movies` data set in the `ggplot2movies` data set, make a
Shiny app that

* Plots budget on the x-axis and rating on the y-axis
* Instead of having a radio button to select the genre of movie (`Action`,
`Animation`, `Comedy`, etc), have a radio button that allows you to toggle
between comedies and non-comedies. This app should be simpler.

